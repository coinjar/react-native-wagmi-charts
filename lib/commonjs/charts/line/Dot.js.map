{"version":3,"sources":["Dot.tsx"],"names":["AnimatedCircle","Animated","createAnimatedComponent","Circle","LineChartDot","displayName","at","color","defaultColor","dotProps","hasOuterDot","defaultHasOuterDot","hasPulse","inactiveColor","outerDotProps","pulseBehaviour","pulseDurationMs","showInactiveColor","size","outerSize","data","isActive","path","pathWidth","width","React","useContext","LineChartDimensionsContext","isInactive","_isInactive","LineChartPathContext","opacity","parsedPath","useMemo","pointWidth","length","x","y","value","animatedDotProps","cx","cy","animatedOuterDotProps","defaultProps","r","easing","Easing","out","sin","animatedOpacity","duration","scale"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport Animated, {\n  Easing,\n  useAnimatedProps,\n  useDerivedValue,\n  withRepeat,\n  withSequence,\n  withTiming,\n} from 'react-native-reanimated';\nimport { Circle, CircleProps } from 'react-native-svg';\nimport { getYForX, parse } from 'react-native-redash';\n\nimport { LineChartDimensionsContext } from './Chart';\nimport { LineChartPathContext } from './ChartPath';\nimport { useLineChart } from './useLineChart';\n\nconst AnimatedCircle = Animated.createAnimatedComponent(Circle);\n\nexport type LineChartDotProps = {\n  dotProps?: Animated.AnimateProps<CircleProps>;\n  outerDotProps?: Animated.AnimateProps<CircleProps>;\n  color?: string;\n  inactiveColor?: string;\n  showInactiveColor?: boolean;\n  at: number;\n  size?: number;\n  hasPulse?: boolean;\n  hasOuterDot?: boolean;\n  /**\n   * If `always`, the outer dot will still animate when interaction is active.\n   *\n   * If `while-inactive`, the outer dot will animate only when the interaction is inactive.\n   *\n   * Default: `while-inactive`\n   */\n  pulseBehaviour?: 'always' | 'while-inactive';\n  /**\n   * Defaults to `size * 4`\n   */\n  outerSize?: number;\n  pulseDurationMs?: number;\n};\n\nLineChartDot.displayName = 'LineChartDot';\n\nexport function LineChartDot({\n  at,\n  color: defaultColor = 'black',\n  dotProps,\n  hasOuterDot: defaultHasOuterDot = false,\n  hasPulse = false,\n  inactiveColor,\n  outerDotProps,\n  pulseBehaviour = 'while-inactive',\n  pulseDurationMs = 800,\n  showInactiveColor = true,\n  size = 4,\n  outerSize = size * 4,\n}: LineChartDotProps) {\n  const { data, isActive } = useLineChart();\n  const { path, pathWidth: width } = React.useContext(\n    LineChartDimensionsContext\n  );\n\n  ////////////////////////////////////////////////////////////\n\n  const { isInactive: _isInactive } = React.useContext(LineChartPathContext);\n  const isInactive = showInactiveColor && _isInactive;\n  const color = isInactive ? inactiveColor || defaultColor : defaultColor;\n  const opacity = isInactive && !inactiveColor ? 0.5 : 1;\n  const hasOuterDot = defaultHasOuterDot || hasPulse;\n\n  ////////////////////////////////////////////////////////////\n\n  const parsedPath = React.useMemo(() => parse(path), [path]);\n\n  ////////////////////////////////////////////////////////////\n\n  const pointWidth = React.useMemo(\n    () => width / (data.length - 1),\n    [data.length, width]\n  );\n\n  ////////////////////////////////////////////////////////////\n\n  const x = useDerivedValue(() => withTiming(pointWidth * at));\n  const y = useDerivedValue(() =>\n    withTiming(getYForX(parsedPath!, x.value) || 0)\n  );\n\n  ////////////////////////////////////////////////////////////\n\n  const animatedDotProps = useAnimatedProps(() => ({\n    cx: x.value,\n    cy: y.value,\n  }));\n\n  const animatedOuterDotProps = useAnimatedProps(() => {\n    let defaultProps = {\n      cx: x.value,\n      cy: y.value,\n      opacity: 0.1,\n      r: outerSize,\n    };\n\n    if (!hasPulse) {\n      return defaultProps;\n    }\n\n    if (isActive.value && pulseBehaviour === 'while-inactive') {\n      return {\n        ...defaultProps,\n        r: 0,\n      };\n    }\n\n    const easing = Easing.out(Easing.sin);\n    const animatedOpacity = withRepeat(\n      withSequence(\n        withTiming(0.8),\n        withTiming(0, {\n          duration: pulseDurationMs,\n          easing,\n        })\n      ),\n      -1,\n      false\n    );\n    const scale = withRepeat(\n      withSequence(\n        withTiming(0),\n        withTiming(outerSize, {\n          duration: pulseDurationMs,\n          easing,\n        })\n      ),\n      -1,\n      false\n    );\n\n    if (pulseBehaviour === 'while-inactive') {\n      return {\n        ...defaultProps,\n        opacity: isActive.value ? withTiming(0) : animatedOpacity,\n        r: isActive.value ? withTiming(0) : scale,\n      };\n    }\n    return {\n      ...defaultProps,\n      opacity: animatedOpacity,\n      r: scale,\n    };\n  }, [outerSize]);\n\n  ////////////////////////////////////////////////////////////\n\n  return (\n    <>\n      <AnimatedCircle\n        animatedProps={animatedDotProps}\n        r={size}\n        fill={color}\n        opacity={opacity}\n        {...dotProps}\n      />\n      {hasOuterDot && (\n        <AnimatedCircle\n          animatedProps={animatedOuterDotProps}\n          fill={color}\n          {...outerDotProps}\n        />\n      )}\n    </>\n  );\n}\n"]}